# Measure Theory #

- *Measure theory* studies *assigning values to subsets*.
- Measure theory is the corner stone of many math subjects
	- Modern approach to integration is based on measure theory.
	- Modern probability theory is based entirely on measure theory.
- Intuitively, the *measure* of a set can be intepreted as the *size*, *e.g.* the length of an interval.

. . .

- Why is this so challenging?

---

# Lengths of Real Subsets #

- How long are these subsets: $(a, b)$, $[a, b]$, and $\{a\}$?

. . .

- What is the length of $\mathbb{N}$?

. . .

- Now let's try to compute the length of $(a, b)$ by *decomposing it into infinitely many points*:
    
    $$\sum_{x \in (a, b)} \mathrm{len}(x) = \sum_{x \in (a, b)} 0 = \cdots ?$$
    
. . .

- Sizes (*e.g.* lengths, areas, and volumes) are *countably additive*.
- Let $\mathcal{C}$ be a collection of subsets of $\Omega$, then a function $f: \mathcal{C} \rightarrow \mathbb{R}$ is said to be *countably additive*, if for any *finite* or *countable* sequence of *disjoint* subsets $A_1, A_2, \ldots \in \mathcal{A}$, it has

    $$f\left(\bigcup_i A_i\right) = \sum_{i=1}^n f(A_i)$$.

---

# The Vitali Set #

- Let's consider a very interesting subset of $[0, 1]$, called *Vitali set*, constructed as follows:
    - We say $x$ and $y$ are equivalent, if $x - y \in \mathbb{Q}$.
    - $[0, 1]$ can then be partitioned into multiple equivalent classes.
    - There are *incountably infinite* such equivalent classes
    - By *axiom of choices*, we can form a set $V$, which contains *one* representative from each equivalent class.

. . .

- **Question:** the length of $V$?

. . .

- Try to derive the length of $V$:
    - enumerate all rational numbers within $[0, 1]$ as $q_1, q_2, \ldots$, and let $V_k = V + q_k$
    - Obviously, $V_1, V_2, \ldots$ are disjoint
    - Let $U = \bigcup_k V_k$, then $[0, 1] \subset U \subset [-1, 2]$, and therefore $1 \le \mathrm{len}(U) \le 3$.
    - However, if $\mathrm{len}(V) = 0$, then $\mathrm{len}(U) = 0$, or if $\mathrm{len}(V) > 0$, then $\mathrm{len}(U) = \infty$ ...

---

# $\sigma$-algebra #

- $\mathcal{S}$, a nonempty collection of subsets of $\Omega$, is called a *ring*, if it is closed under *union* and *set difference*.
    - A ring must contain $\emptyset$.
    - A ring is closed under *intersection*.
- A ring $\mathcal{S}$ is called a *algebra*, if it is also closed under *complement*.
    - An *algebra* must contain $\Omega$.
- An *algebra* is called a $\sigma$-algebra, if it is also closed under *countable union*.
    - A $\sigma$-algebra is closed under countable fold of any elementary set operations.

---

# Measure and Measure Space #

- A countably additive function $\mu$ from a $\sigma$-algebra $\mathcal{S}$ into $[0, \infty]$ is called a *measure*. Then $(\Omega, \mathcal{S}, \mu)$ is called a *measure space*. All the elements of $\mathcal{S}$ are called *measurable sets*.

. . .

- Consider a *measure space* $(\Omega, \mathcal{S}, \mu)$:
    - $\mu(\emptyset) = 0$.
    - $A \subset B \Rightarrow \mu(A) \le \mu(B)$.
    - Let $A_1, A_2, \ldots \in \mathcal{S}$ be disjoint, then $\mu(\bigcup_i A_i) = \sum_i \mu(A_i)$.
    - $\mu$ is called a *finite measure* if $\mu(\Omega) < \infty$.
    - $\mu$ is called a *$\sigma$-finite measure* if $\Omega$ is covered by countably many subsets of finite measure.
    - Continuity:
        - $A_1 \subset A_2 \subset \ldots \Rightarrow \mu(A_i) \uparrow \mu\left( \bigcup_i A_i \right)$.
        - $A_1 \supset A_2 \supset \ldots \Rightarrow \mu(A_i) \downarrow \mu \left( \bigcap_i A_i \right)$.

---


# Open Intervals and Their Lengths #

To define a measure over $\mathbb{R}$. Let's first consider the simplest cases -- the intervals.

- The length of an open interval is defined as $\mathrm{len}((a, b)) = b - a$.
- The the length of a finite union of disjoint open intervals is defined to be the sum of the lengths of individual intervals.
- The collection of all finite unions of disjoint open intervals constitutes a *ring*.
    - The length is well defined over this ring, and it satisfies finite additivity. -- Hence, it is called a *pre-measure*.
- Now, we want to extend the length to as many subsets as possible.

---

# Borel $\sigma$-algebra #

Let's first extend the open interval ring to a $\sigma$-algebra:

- Let $\mathcal{C}$ be a collection of subsets. Then the smallest $\sigma$-algebra that contains $\mathcal{C}$ is called the *$\sigma$-algebra generated by $\mathcal{C}$*.
- Let $(\Omega, d)$ be a *metric space*, then the $\sigma$-algebra generated by the open subsets of $\Omega$ is called the *Borel $\sigma$-algebra* of $\Omega$, denoted by $\mathcal{B}$
    - Elements of the Borel $\sigma$-algebra are called *Borel sets*.
    - All the open sets, closed sets, and their finite and countable unions and intersections are all *Borel sets*.
    - Finite or countable sets are all *Borel sets*.
 
---

# Measure Extension #

The next step is to extend the *measure*:

- *(Hahnâ€“Kolmogorov theorem):* Let $\mathcal{C}$ be a ring that covers $\Omega$, $\mu': \mathcal{C} \rightarrow [0, \infty]$ be a *pre-measure*, and $\mathcal{S}$ be the $\sigma$-algebra generated by $\mathcal{C}$, then $\mu'$ can be extended to a measure $\mu: \mathcal{S} \rightarrow [0, \infty]$. If $\mu$ is $\sigma$-finite, then the extension is unique.
- The length function over the open interval ring can be *uniquely extended* to a measure over the Borel $\sigma$-algebra over $\mathbb{R}$, called *Borel measure*.

---

# Lebesgue Measure #

We are not done yet ...

- Given a measure space $(\Omega, \mathcal{S}, \mu)$, a subset $A \subset \Omega$ is called a *null set* if there exists $B \in \mathcal{S}$ with $\mu(B) = 0$ such that $A \subset B$.
- This *measure space* is called a *complete measure space* if every null set is measurable.
- Let $\mathcal{N}(\mu)$ denote the collection of all the *null sets*. Then the $\sigma$-algebra generated by $\mathcal{S} \cup \mathcal{N}(\mu)$ is *complete*. 
- The measure can be straightforwardly extended. The resultant measure space is called the *completion* of $(\Omega, \mathcal{S}, \mu)$.

. . .

- The *Borel measure space* is generally not *complete*. The *completion* of the *Borel measure space* is called the *Lebesgue measure space*, and the extended measure is called *Lebesgue measure*.

---

# Lebesgue Integral: Roadmap #

We derive the *Lebesgue integral* in a way that begins with simple functions and then extends the definition to more complicated functions:

. . .

Let $(\Omega, \mathcal{S}, \mu)$ be a measure space:

- Indicator functions -- the integral of an indicator function $1_A$ of a *measurable* set $A \in \mathcal{S}$ is defined to be the *measure* of $A$, as

	$$\int 1_A d\mu = \mu(A)$$
	
. . .

- Simple functions -- linear combinations of indicator functions:

	$$\int \sum_k \alpha_k 1_{A_k} d\mu = \sum_k \alpha_k \int 1_{A_k} d\mu = \sum_k \alpha_k \mu(A_k)$$

. . .

- Non-negative functions -- through approximation

- Signed functions -- decompose as $f = f_+ - f_-$.

---

# Lebesgue Integral (cont'd) #

- Let $s$ be a *non-negative* function on $\Omega$, then we define

	$$\int f d\mu = \sup \left\{ \int s d\mu: 0 \le s \le f, s \text{ simple} \right\}$$

. . .

- Signed function: decompose $f$ as $f = f_+ - f_-$, with $f_+ = \max(f, 0)$ and $f_- = \max(-f, 0)$, then

	$$\int f d\mu = \int f_+ d\mu - \int f_- d\mu$$

	When both $\int f_+ d\mu$ and $\int f_- d\mu$ are infinite, $\int f d\mu$ is *undefined*.

---

# Properties of Lebesgue Integral #

- $f \mapsto \int f d\mu$ is a linear functional.
- If $f = g \ a.e.$ then $\int f d\mu = \int g d\mu$ (Note: a predicate holds *almost everywhere* means that it holds over $\Omega$, except for a null set) 
- *(Monotonicity)* $f \le g \Rightarrow \int f d\mu \le \int g d\mu$.
- *(Monotone convergence theorem)* Let $(f_k)$ be a sequence of *non-negative* functions, and $f_k \uparrow f$ pointwisely, then $\int f_k d\mu \uparrow \int f d\mu$.
- *(Dominated convergence theorem)* If $f_k \rightarrow f$ pointwisely, $(f_k)$ is *dominated* by $g$, *i.e.* $\forall k \ |f_k| \le g$, and $\int g d\mu < \infty$, then $\int f_k d\mu \rightarrow \int f d\mu$.

---

# Examples #

- The *counting measure* over a *finite* or *countable* space $\Omega$ is defined as the *cardinality* of subsets. 

- Let $\mu$ be a *counting measure* over a countable space $\Omega = \{x_k\}$, then 

	$$\int f d\mu = \sum_k f(x_k)$$ 	

. . .

- Let $f$ be a function over $[a, b]$, then when $f$ is *Riemann integrable*, $f$ must be *Lebesgue integrable* (*w.r.t.* the *Lebesgue measure*), and in such a case, the *Lebesgue integral* is equal to the *Riemann integral*. 

. . .

- **Question:** Consider $1_\mathbb{Q}$:
	- Is it *Riemann integrable*?
	- Compute the *Lebesgue integral* of $1_\mathbb{Q}$ with respect to the *Lebesgue measure* $\mu$.

---

# $L^p$ space #

Given a measure space $(\Omega, \mathcal{S}, \mu)$:

- For any $p \ge 1$, the $L^p$ space of $\Omega$, denoted by $\mathcal{L}^p(\Omega)$, is the vector space comprised of all *measurable* functions on $\Omega$ such that $\int |f|^p d\mu < \infty$, where the norm is defined by

	$$\|f\|_p \triangleq \left( \int |f|^p d\mu \right)^{1/p}$$
	
	Here, $\|\cdot\|_p$ is called the *$L^p$ norm*. 
	
- **Question:** Is $\|\cdot\|_p$ actually a *norm*?

. . .

- Functions that are equal *almost everywhere* are indistinguishable by integration. Let $L^p(\Omega)$ denotes the vector space with all *essentially equivalent* functions merged into an element. Then $L^p$ is a normed vector space with the $L^p$.

---

# $L^p$ space (cont'd) #

- What about when $p = \infty$ ?

. . .

- The $L^\infty$ norm is defined as the *essential supreme* of $|f|$, as

	$$\|f\|_\infty = \inf \left\{c: |f(x)| \le c, \ a.e.\right\}$$


- For any $p \in [1, +\infty]$, $L^p$ is complete, implying that $L^p$ is a Banach space.

- The dual space of $L^p$ is isomorphic to $L^q$ with $p^{-1} + q^{-1} = 1$. For each bounded functional on $h \in L^p$, there exists $g \in L^q$, such that 

	$$h(f) = \int f g d\mu, \ \forall f \in L^p$$

. . .

- $L^2$ is a Hilbert space, where the inner product is defined as

	$$\langle f, g \rangle \triangleq \int f g d\mu$$

---

# Absolute Continuity #

Let $\mu$ and $\nu$ be two measures over a measurable space $(\Omega, \mathcal{S})$

- $\nu$ is said to be *absolutely continuous* with respect to $\mu$, denoted by $\nu \prec \mu$, if $\nu(A) = 0$ whenever $\mu(A) = 0$.

- $\mu$ and $\nu$ are said to be *singular*, denoted by $\mu \perp \nu$, if there exists $A \in \mathcal{S}$ such that $\mu(A) = 0$ and $\nu(\Omega \backslash A) = 0$.

- *(Lebesgue Decomposition)* there exists a unique decomposition of $\nu$ as $\nu = \nu_{ac} + \nu_{s}$ such that $\nu_{ac} \prec \mu$ and $\nu_s \perp \mu$.

---

# Radon-Nikodym #

*(Radon-Nikodym theorem)* Let $\nu$ be a finite measure that is *absolutely continuous* with respect to $\mu$. Then there exists an *essentially* unique $h \in L^1(\Omega, \mathcal{S}, \mu)$ such that 

$$\nu(A) = \int_A h d\mu, \ \forall A \in \mathcal{S}$$
	
Here, $\nu$ is called the *Radon-Nikodym density* of $\nu$ with respect to $\mu$. In this case, we also have
	
$$\int f d\nu = \int f h d\mu, \ \forall f \in L^1(\Omega, \mathcal{S}, \nu)$$
	
---

# Probability Measure #

- A *probability measure* $P$ is a measure on $(\Omega, \mathcal{S})$ with $P(\Omega) = 1$.
- The $\sigma$-algebra $\mathcal{S}$ can be interpreted as an *event space*:
	- Each element $A \in \mathcal{S}$, which is a subset of $\Omega$, can be considered as an *event*.
	- $A \cap B$ means *both $A$ and $B$ happen
	- $A \cup B$ means either $A$ or $B$ happens
	- $A^c$ means $A$ does not happen
	- $A \cap B = \emptyset$ means that $A$ and $B$ are *mutually exclusive*.
- $P(A)$ can be considered as the *probability* of the event $A$.
- Obviously, $P$ satisfies all the requirement of probability functions in classical probability theory.

. . .

- Two events $A$ and $B$ are said to be *independent* if $P(A \cap B) = P(A) P(B)$.
- We say two collections of events $\mathcal{A}$ and $\mathcal{B}$ are *independent* when $P(A \cap B) = P(A)P(B) \ \forall A \in \mathcal{A}, B \in \mathcal{B}$.

---

# Random Variables #

- A *(real-valued) random variable* $X$ is defined to be a *measurable function* $X: \Omega \rightarrow \mathbb{R}$, meaning that for any Borel set $A \in \mathcal{B}(R)$, $X^{-1}(A)$ is measurable, *i.e.* $X^{-1}(A) \in \mathcal{S}$.

- The *expectation* of a random variable $X$ is defined to be
	
	$$E[X] = \int X dP$$ 

- The *expectation* is a *bounded linear functional*.

. . .

- Each random variable $X$ induces a sub-$\sigma$-algebra, denoted by $X^{-1}(\mathcal{B})$, where $\mathcal{B}$ is the Borel $\sigma$-algebra on $\mathbb{R}$.

- Two random variables $X$ and $Y$ are said to be *independent* if $X^{-1}(\mathcal{B})$ and $Y^{-1}(\mathcal{B})$ are independent.

---

# Probability Density #

- The probability that the value of $X$ falling in $A$ is then given by $P(X^{-1}(A))$. 
	- The function $P \circ X^{-1}$ that maps each Borel set $A \subset \mathbb{R}$ to a *probability value* itself is a *probability measure* over $\mathbb{R}$, which is called the *law* of $X$, denoted by $X_*P$.

- The Radon-Nikodym density of $X_*P$ with respect to the Lebesgue measure over $\mathbb{R}$, denoted by $f$, is called the *probability density* of $X$. So we have $f d\mu = d X_*P$.
 
---

# (Semantic) Correspondence #

| **measure theory** | **probability theory** |  
|  ------	| ------	|  
| $\sigma$-algebra | event space |  
| sub-$\sigma$-algebra | a family of events |
| measure $P$ | probability function |    
| measurable function $X$ | random variable |  
| $X_*P$ | law of $X$ |
| integration | expectation |  
| Radon-Nikodym density of $X_*P$ | probability density |








